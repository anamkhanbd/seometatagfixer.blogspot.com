<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meta Tag Fixer - AI SEO Tool</title>
    <!-- Favicon: SEO Magnifying Glass -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%230ea5e9' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='11' cy='11' r='8'/%3E%3Cpath d='m21 21-4.3-4.3'/%3E%3Cpath d='M11 8v6' stroke='%230ea5e9' stroke-width='2'/%3E%3Cpath d='M8 11h6' stroke='%230ea5e9' stroke-width='2'/%3E%3C/svg%3E">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            colors: {
              brand: {
                50: '#f0f9ff',
                100: '#e0f2fe',
                500: '#0ea5e9',
                600: '#0284c7',
                700: '#0369a1',
                900: '#0c4a6e',
              }
            }
          }
        }
      }
    </script>
    <!-- Babel for in-browser JSX compilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Import Map for Modules -->
    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18.2.0",
    "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
    "lucide-react": "https://esm.sh/lucide-react@0.263.1?deps=react@18.2.0",
    "@google/genai": "https://esm.sh/@google/genai@1.37.0",
    "recharts": "https://esm.sh/recharts@2.12.0?deps=react@18.2.0,react-dom@18.2.0",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
    <style>
        .dark ::-webkit-scrollbar { width: 8px; }
        .dark ::-webkit-scrollbar-track { background: #0f172a; }
        .dark ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        .dark ::-webkit-scrollbar-thumb:hover { background: #475569; }
    </style>
</head>
<body class="bg-gray-50 text-gray-900 dark:bg-slate-900 dark:text-gray-100 transition-colors duration-300">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
    // <![CDATA[
      import React, { useState, useEffect, useRef, memo } from 'react';
      import ReactDOM from 'react-dom/client';
      import { 
        Wand2, Loader2, Trash2, Sparkles, Moon, Sun, Globe, Copy, Check, 
        Download, Code, Hash, Activity, FileJson, FileText, Tag, 
        ArrowRight, Calendar, Rss, ExternalLink 
      } from 'lucide-react';
      import { GoogleGenAI, Type } from '@google/genai';
      import { PieChart, Pie, Cell, ResponsiveContainer } from 'recharts';

      // --- CONFIGURATION ---
      const getApiKey = () => {
        try {
          if (typeof process !== 'undefined' && process.env && process.env.API_KEY) {
            return process.env.API_KEY;
          }
        } catch (e) {
          console.warn('Error reading process.env:', e);
        }
        return 'AIzaSyAK2JnWt67oAvgdRLEMwkJUhRZyyl2kyzY'; 
      };

      const GENAI_API_KEY = getApiKey();
      
      const AD_KEY_160_600 = 'f2668bd84268bc931195baa771060cd0';
      const AD_KEY_728_90 = '1db833156a625059c199f61f676c8b04';

      // --- CONSTANTS ---
      const DICTIONARY = {
        en: {
            title: "Meta Tag Fixer",
            tagline: "AI-Powered Meta Tag Generator for Better SEO",
            inputPlaceholder: "Paste your article, blog post, or webpage content here to generate SEO tags...",
            generateMeta: "Generate Meta Tags",
            generateHtml: "Generate HTML Code",
            analyzing: "AI Analyzing Content...",
            results: "Analysis Results",
            tabMeta: "Meta Tags",
            tabHtml: "HTML Code",
            tabKeywords: "Keywords",
            tabScore: "SEO Score",
            copy: "Copy",
            copied: "Copied!",
            downloadJson: "Export JSON",
            downloadTxt: "Export TXT",
            keywordsPrimary: "Primary Keywords",
            keywordsSecondary: "Secondary Keywords",
            keywordsLongTail: "Long-tail Keywords",
            scoreTitle: "Content Readiness Score",
            scoreGood: "Excellent",
            scoreAverage: "Needs Improvement",
            scorePoor: "Poor",
            tipsTitle: "Improvement Suggestions",
            clear: "Clear All",
            errorEmpty: "Please enter some text to analyze.",
            errorApi: "Failed to generate data. Please try again.",
        },
        bn: {
            title: "মেটা ট্যাগ ফিক্সার",
            tagline: "উন্নত এসইও-এর জন্য এআই চালিত মেটা ট্যাগ জেনারেটর",
            inputPlaceholder: "এসইও ট্যাগ তৈরি করতে আপনার আর্টিকেল, ব্লগ পোস্ট বা ওয়েবপেজের বিষয়বস্তু এখানে পেস্ট করুন...",
            generateMeta: "মেটা ট্যাগ তৈরি করুন",
            generateHtml: "HTML কোড তৈরি করুন",
            analyzing: "এআই বিশ্লেষণ করছে...",
            results: "বিশ্লেষণের ফলাফল",
            tabMeta: "মেটা ট্যাগ",
            tabHtml: "HTML কোড",
            tabKeywords: "কিওয়ার্ডস",
            tabScore: "এসইও স্কোর",
            copy: "কপি",
            copied: "কপি হয়েছে!",
            downloadJson: "JSON ডাউনলোড",
            downloadTxt: "TXT ডাউনলোড",
            keywordsPrimary: "প্রধান কিওয়ার্ড",
            keywordsSecondary: "সহায়ক কিওয়ার্ড",
            keywordsLongTail: "লং-টেইল কিওয়ার্ড",
            scoreTitle: "বিষয়বস্তু প্রস্তুতির স্কোর",
            scoreGood: "চমৎকার",
            scoreAverage: "উন্নতি প্রয়োজন",
            scorePoor: "দুর্বল",
            tipsTitle: "উন্নতির পরামর্শ",
            clear: "মুছে ফেলুন",
            errorEmpty: "অনুগ্রহ করে বিশ্লেষণের জন্য কিছু লেখা দিন।",
            errorApi: "ডেটা তৈরি করতে ব্যর্থ হয়েছে। অনুগ্রহ করে আবার চেষ্টা করুন।",
        }
      };

      // --- SERVICE ---
      const analyzeContent = async (text, language) => {
        if (!GENAI_API_KEY) {
            alert("API Key is missing. Please check your configuration.");
            throw new Error("API Key is missing");
        }

        const ai = new GoogleGenAI({ apiKey: GENAI_API_KEY });
        const model = "gemini-3-flash-preview";
        
        const prompt = `
            Analyze the following text for SEO purposes. The user's UI language is ${language === 'bn' ? 'Bengali' : 'English'}, so ensure the analysis tips are in ${language === 'bn' ? 'Bengali' : 'English'}, but keep the generated meta tags (title, description, keywords) appropriate for the content's language (detect the content language automatically).

            Return a valid JSON object with the following structure:
            - title: An SEO optimized title (approx 50-60 chars).
            - description: An SEO optimized meta description (approx 150-160 chars).
            - keywords: An array of strings containing mixed keywords.
            - robots: Default to "index, follow".
            - author: Infer an author name if possible, otherwise leave blank.
            - score: An integer from 0 to 100 representing SEO readiness based on content depth, keyword usage, and readability.
            - tips: An array of strings with actionable advice to improve the content's SEO.
            - keywordsDetailed: An object containing three arrays of strings: 'primary' (main topics), 'secondary' (related terms), and 'longTail' (phrases).

            Content to analyze:
            """
            ${text.substring(0, 10000)}
            """
        `;

        try {
            const response = await ai.models.generateContent({
            model,
            contents: prompt,
            config: {
                responseMimeType: "application/json",
                responseSchema: {
                type: Type.OBJECT,
                properties: {
                    title: { type: Type.STRING },
                    description: { type: Type.STRING },
                    keywords: { type: Type.ARRAY, items: { type: Type.STRING } },
                    robots: { type: Type.STRING },
                    author: { type: Type.STRING },
                    score: { type: Type.INTEGER },
                    tips: { type: Type.ARRAY, items: { type: Type.STRING } },
                    keywordsDetailed: {
                    type: Type.OBJECT,
                    properties: {
                        primary: { type: Type.ARRAY, items: { type: Type.STRING } },
                        secondary: { type: Type.ARRAY, items: { type: Type.STRING } },
                        longTail: { type: Type.ARRAY, items: { type: Type.STRING } },
                    }
                    }
                }
                }
            }
            });

            console.log("Raw Response:", response.text);

            let resultText = response.text;
            if (!resultText) throw new Error("Empty response from AI");
            
            resultText = resultText.trim();
            if (resultText.startsWith('```json')) {
                resultText = resultText.replace(/^```json\s*/, '').replace(/\s*```$/, '');
            } else if (resultText.startsWith('```')) {
                 resultText = resultText.replace(/^```\s*/, '').replace(/\s*```$/, '');
            }

            return JSON.parse(resultText);
        } catch (error) {
            console.error("Gemini Analysis Error:", error);
            throw error;
        }
      };

      // --- COMPONENTS ---

      // AdUnit
      const AdUnit = memo(({ adKey, width, height, className = '' }) => {
        const containerRef = useRef(null);
        const [scale, setScale] = useState(1);

        const srcDoc = `
            <!DOCTYPE html>
            <html lang="en">
            <head>
            <meta charset="UTF-8">
            <style>
                body { margin: 0; padding: 0; display: flex; justify-content: center; align-items: center; background: transparent; overflow: hidden; }
            </style>
            </head>
            <body>
            <script type="text/javascript">
                atOptions = {
                'key' : '${adKey}',
                'format' : 'iframe',
                'height' : ${height},
                'width' : ${width},
                'params' : {}
                };
            <\/script>
            <script type="text/javascript" src="https://www.highperformanceformat.com/${adKey}/invoke.js"><\/script>
            </body>
            </html>
        `;

        useEffect(() => {
            const updateScale = () => {
            if (containerRef.current) {
                const parent = containerRef.current.parentElement;
                if (parent) {
                    const availableWidth = parent.clientWidth - 16;
                    const newScale = Math.min(1, availableWidth / width);
                    setScale(newScale > 0 ? newScale : 1);
                }
            }
            };

            const observer = new ResizeObserver(updateScale);
            if (containerRef.current?.parentElement) {
                observer.observe(containerRef.current.parentElement);
            }
            
            updateScale();
            window.addEventListener('resize', updateScale);

            return () => {
                observer.disconnect();
                window.removeEventListener('resize', updateScale);
            };
        }, [width]);

        return (
            <div 
            ref={containerRef}
            className={`flex flex-col items-center justify-center ${className}`}
            >
            <span className="text-[10px] text-gray-400 dark:text-gray-500 mb-1 uppercase tracking-widest font-medium">
                Advertisement
            </span>
            <div 
                className="bg-gray-100 dark:bg-slate-900/50 border border-gray-200 dark:border-slate-800 rounded-lg overflow-hidden transition-all duration-300 shadow-sm"
                style={{ 
                width: width * scale, 
                height: height * scale,
                position: 'relative'
                }}
            >
                <div style={{
                width: width,
                height: height,
                transform: `scale(${scale})`,
                transformOrigin: 'top left',
                }}>
                <iframe
                    title={`ad-${adKey}`}
                    srcDoc={srcDoc}
                    width={width}
                    height={height}
                    style={{ border: 'none', overflow: 'hidden', display: 'block' }}
                    scrolling="no"
                    loading="lazy"
                />
                </div>
            </div>
            </div>
        );
      });

      // Header
      const Header = ({ lang, setLang, isDark, setIsDark, t }) => {
        return (
            <header className="sticky top-0 z-50 w-full backdrop-blur-md bg-white/80 dark:bg-slate-900/80 border-b border-gray-200 dark:border-slate-800 shadow-sm transition-colors duration-300">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div className="flex justify-between items-center h-16">
                <div className="flex items-center gap-2">
                    <div className="p-2 bg-brand-600 rounded-lg text-white">
                    <Sparkles size={24} />
                    </div>
                    <div className="flex flex-col">
                    <h1 className="text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-brand-600 to-indigo-600 dark:from-brand-500 dark:to-indigo-400">
                        {t.title}
                    </h1>
                    <span className="text-xs text-gray-500 dark:text-gray-400 hidden sm:block">
                        {t.tagline}
                    </span>
                    </div>
                </div>
                <div className="flex items-center gap-3">
                    <button
                    onClick={() => setLang(lang === 'en' ? 'bn' : 'en')}
                    className="flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium bg-gray-100 dark:bg-slate-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors"
                    >
                    <Globe size={16} />
                    <span>{lang === 'en' ? 'EN' : 'BN'}</span>
                    </button>
                    <button
                    onClick={() => setIsDark(!isDark)}
                    className="p-2 rounded-full bg-gray-100 dark:bg-slate-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-slate-700 transition-colors"
                    aria-label="Toggle Theme"
                    >
                    {isDark ? <Sun size={20} /> : <Moon size={20} />}
                    </button>
                </div>
                </div>
            </div>
            </header>
        );
      };

      // SEOScore
      const SEOScore = ({ score, tips, t }) => {
        const validScore = (typeof score === 'number' && !isNaN(score)) ? score : 0;
        
        const data = [
            { name: 'Score', value: validScore },
            { name: 'Remaining', value: 100 - validScore },
        ];

        let color = '#ef4444';
        let statusText = t.scorePoor;

        if (validScore >= 80) {
            color = '#22c55e';
            statusText = t.scoreGood;
        } else if (validScore >= 50) {
            color = '#eab308';
            statusText = t.scoreAverage;
        }

        return (
            <div className="flex flex-col md:flex-row gap-8 items-center justify-center p-6 bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-100 dark:border-slate-700">
            <div className="relative w-48 h-48 flex-shrink-0">
                <ResponsiveContainer width="100%" height="100%">
                <PieChart>
                    <Pie
                    data={data}
                    cx="50%"
                    cy="50%"
                    innerRadius={60}
                    outerRadius={80}
                    startAngle={90}
                    endAngle={-270}
                    dataKey="value"
                    stroke="none"
                    >
                    <Cell key="cell-0" fill={color} />
                    <Cell key="cell-1" fill="#e2e8f0" className="dark:fill-slate-700" />
                    </Pie>
                </PieChart>
                </ResponsiveContainer>
                <div className="absolute inset-0 flex flex-col items-center justify-center">
                <span className="text-4xl font-bold text-gray-900 dark:text-white">{validScore}</span>
                <span className="text-xs uppercase font-semibold text-gray-500 dark:text-gray-400">/ 100</span>
                </div>
            </div>
            <div className="flex-1 w-full">
                <h3 className="text-lg font-semibold text-gray-900 dark:text-white mb-2">{t.scoreTitle}</h3>
                <div className="flex items-center gap-2 mb-4">
                    <div className="w-3 h-3 rounded-full" style={{backgroundColor: color}}></div>
                    <span className="font-medium" style={{color: color}}>{statusText}</span>
                </div>
                <div className="space-y-3">
                    <h4 className="text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">{t.tipsTitle}</h4>
                    <ul className="space-y-2">
                        {tips.length > 0 ? (
                            tips.slice(0, 3).map((tip, idx) => (
                                <li key={idx} className="flex items-start gap-2 text-sm text-gray-700 dark:text-gray-300">
                                <span className="mt-1 block w-1.5 h-1.5 rounded-full bg-brand-500 flex-shrink-0"></span>
                                {tip}
                                </li>
                            ))
                        ) : (
                            <li className="text-sm text-gray-500 italic">No specific tips available.</li>
                        )}
                    </ul>
                </div>
            </div>
            </div>
        );
      };

      // ResultTabs
      const ResultTabs = ({ data, html, t, onExport }) => {
        const [activeTab, setActiveTab] = useState('meta');
        const [copied, setCopied] = useState(null);

        const handleCopy = (text, id) => {
            navigator.clipboard.writeText(text);
            setCopied(id);
            setTimeout(() => setCopied(null), 2000);
        };

        const tabs = [
            { id: 'meta', label: t.tabMeta, icon: <Tag size={16} /> },
            { id: 'html', label: t.tabHtml, icon: <Code size={16} /> },
            { id: 'keywords', label: t.tabKeywords, icon: <Hash size={16} /> },
            { id: 'score', label: t.tabScore, icon: <Activity size={16} /> },
        ];

        return (
            <div className="bg-white dark:bg-slate-800 rounded-xl shadow-lg border border-gray-200 dark:border-slate-700 overflow-hidden">
            <div className="flex flex-wrap border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-900/50">
                {tabs.map((tab) => (
                <button
                    key={tab.id}
                    onClick={() => setActiveTab(tab.id)}
                    className={`flex items-center gap-2 px-6 py-4 text-sm font-medium transition-all duration-200 border-b-2 outline-none ${activeTab === tab.id ? 'border-brand-500 text-brand-600 dark:text-brand-400 bg-white dark:bg-slate-800' : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-800/50'}`}
                >
                    {tab.icon}
                    {tab.label}
                </button>
                ))}
                <div className="flex-grow flex items-center justify-end px-4 py-2 gap-2">
                    <button onClick={() => onExport('json')} className="flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-gray-600 dark:text-gray-300 bg-gray-200 dark:bg-slate-700 rounded hover:bg-gray-300 dark:hover:bg-slate-600 transition-colors">
                        <FileJson size={14} /> {t.downloadJson}
                    </button>
                    <button onClick={() => onExport('txt')} className="flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-gray-600 dark:text-gray-300 bg-gray-200 dark:bg-slate-700 rounded hover:bg-gray-300 dark:hover:bg-slate-600 transition-colors">
                        <FileText size={14} /> {t.downloadTxt}
                    </button>
                </div>
            </div>
            <div className="p-6">
                {activeTab === 'meta' && (
                <div className="space-y-6">
                    <div className="group relative">
                    <label className="block text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-1">Title Tag</label>
                    <div className="p-4 bg-gray-50 dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700 text-gray-800 dark:text-gray-200 font-medium">{data.title}</div>
                    <button onClick={() => handleCopy(data.title, 'title')} className="absolute top-8 right-2 p-2 rounded-md text-gray-400 hover:text-brand-600 dark:hover:text-brand-400 bg-white dark:bg-slate-800 shadow-sm opacity-0 group-hover:opacity-100 transition-all">
                        {copied === 'title' ? <Check size={16} /> : <Copy size={16} />}
                    </button>
                    </div>
                    <div className="group relative">
                    <label className="block text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-1">Meta Description</label>
                    <div className="p-4 bg-gray-50 dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700 text-gray-800 dark:text-gray-200 leading-relaxed">{data.description}</div>
                    <button onClick={() => handleCopy(data.description, 'desc')} className="absolute top-8 right-2 p-2 rounded-md text-gray-400 hover:text-brand-600 dark:hover:text-brand-400 bg-white dark:bg-slate-800 shadow-sm opacity-0 group-hover:opacity-100 transition-all">
                        {copied === 'desc' ? <Check size={16} /> : <Copy size={16} />}
                    </button>
                    </div>
                    <div className="group relative">
                    <label className="block text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-1">Robots</label>
                    <div className="p-4 bg-gray-50 dark:bg-slate-900 rounded-lg border border-gray-200 dark:border-slate-700 text-gray-800 dark:text-gray-200 font-mono text-sm">{data.robots}</div>
                    </div>
                </div>
                )}
                {activeTab === 'html' && (
                <div className="relative group">
                    <pre className="p-6 bg-slate-900 rounded-lg overflow-x-auto border border-slate-700"><code className="text-sm font-mono text-blue-300">{html}</code></pre>
                    <button onClick={() => handleCopy(html, 'html')} className="absolute top-4 right-4 flex items-center gap-2 px-3 py-1.5 rounded-md bg-white/10 hover:bg-white/20 text-white text-xs font-medium backdrop-blur-sm transition-colors">
                    {copied === 'html' ? <Check size={14} /> : <Copy size={14} />} {copied === 'html' ? t.copied : t.copy}
                    </button>
                </div>
                )}
                {activeTab === 'keywords' && (
                <div className="space-y-6">
                    <div>
                    <h4 className="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3 flex items-center gap-2"><span className="w-2 h-2 rounded-full bg-brand-500"></span>{t.keywordsPrimary}</h4>
                    <div className="flex flex-wrap gap-2">{data.keywordsDetailed.primary.map((k, i) => (<span key={i} onClick={() => handleCopy(k, 'k-p-'+i)} className="px-3 py-1.5 rounded-full bg-brand-50 text-brand-700 dark:bg-brand-900/30 dark:text-brand-300 text-sm font-medium border border-brand-100 dark:border-brand-800 cursor-pointer hover:bg-brand-100 dark:hover:bg-brand-900/50 transition-colors">{String(k)}</span>))}</div>
                    </div>
                    <div>
                    <h4 className="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3 flex items-center gap-2"><span className="w-2 h-2 rounded-full bg-indigo-500"></span>{t.keywordsSecondary}</h4>
                    <div className="flex flex-wrap gap-2">{data.keywordsDetailed.secondary.map((k, i) => (<span key={i} onClick={() => handleCopy(k, 'k-s-'+i)} className="px-3 py-1.5 rounded-full bg-indigo-50 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-300 text-sm font-medium border border-indigo-100 dark:border-indigo-800 cursor-pointer hover:bg-indigo-100 dark:hover:bg-indigo-900/50 transition-colors">{String(k)}</span>))}</div>
                    </div>
                    <div>
                    <h4 className="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3 flex items-center gap-2"><span className="w-2 h-2 rounded-full bg-emerald-500"></span>{t.keywordsLongTail}</h4>
                    <div className="flex flex-wrap gap-2">{data.keywordsDetailed.longTail.map((k, i) => (<span key={i} onClick={() => handleCopy(k, 'k-l-'+i)} className="px-3 py-1.5 rounded-full bg-emerald-50 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-300 text-sm font-medium border border-emerald-100 dark:border-emerald-800 cursor-pointer hover:bg-emerald-100 dark:hover:bg-emerald-900/50 transition-colors">{String(k)}</span>))}</div>
                    </div>
                </div>
                )}
                {activeTab === 'score' && <SEOScore score={data.score} tips={data.tips} t={t} />}
            </div>
            </div>
        );
      };

      // --- NEW COMPONENT: LatestPosts ---
      const LatestPosts = () => {
        const [posts, setPosts] = useState([]);
        const [loading, setLoading] = useState(true);
        const [error, setError] = useState(false);

        useEffect(() => {
            const fetchPosts = async () => {
            try {
                // Fetching from seometatagfixer.blogspot.com
                const res = await fetch('https://seometatagfixer.blogspot.com/feeds/posts/summary?alt=json&max-results=3');
                
                if (!res.ok) throw new Error('Failed to fetch');
                
                const data = await res.json();
                
                if (data.feed && data.feed.entry) {
                    const formattedPosts = data.feed.entry.map((entry) => {
                    const link = entry.link.find((l) => l.rel === 'alternate')?.href || '#';
                    
                    let thumbnail = 'https://placehold.co/600x315/f1f5f9/64748b?text=No+Image';
                    if (entry.media$thumbnail?.url) {
                        thumbnail = entry.media$thumbnail.url.replace(/\/s72\-c\//, '/w600-h315-c/');
                    }
                    
                    const date = new Date(entry.published.$t).toLocaleDateString('en-US', {
                        month: 'short', day: 'numeric', year: 'numeric'
                    });
                    
                    const rawSummary = entry.summary?.$t || '';
                    const summary = rawSummary.length > 100 ? rawSummary.substring(0, 100) + '...' : rawSummary;

                    return {
                        id: entry.id.$t,
                        title: entry.title.$t,
                        url: link,
                        thumbnail,
                        date,
                        summary
                    };
                    });
                    setPosts(formattedPosts);
                }
            } catch (error) {
                console.error("Failed to fetch posts", error);
                setError(true);
            } finally {
                setLoading(false);
            }
            };

            fetchPosts();
        }, []);

        if (loading) {
            return (
                <div className="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6 animate-pulse">
                    {[1, 2, 3].map((i) => (
                        <div key={i} className="bg-gray-200 dark:bg-slate-800 h-64 rounded-xl"></div>
                    ))}
                </div>
            );
        }

        if (error || posts.length === 0) return null;

        return (
            <div className="mt-12 animate-in fade-in slide-in-from-bottom-8 duration-700">
            <div className="flex items-center justify-between mb-6 px-1">
                <div className="flex items-center gap-2">
                    <div className="p-1.5 bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400 rounded-lg">
                        <Rss size={20} />
                    </div>
                    <h2 className="text-xl font-bold text-gray-800 dark:text-white">Latest SEO Tips & Updates</h2>
                </div>
                <a href="https://seometatagfixer.blogspot.com/" target="_blank" rel="noopener noreferrer" className="text-sm font-medium text-brand-600 dark:text-brand-400 hover:underline flex items-center gap-1">
                    View Blog <ExternalLink size={14} />
                </a>
            </div>
            
            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                {posts.map(post => (
                <a 
                    key={post.id} 
                    href={post.url} 
                    target="_blank" 
                    rel="noopener noreferrer"
                    className="group flex flex-col bg-white dark:bg-slate-800 rounded-xl overflow-hidden shadow-sm hover:shadow-lg border border-gray-200 dark:border-slate-700 transition-all duration-300 hover:-translate-y-1"
                >
                    <div className="relative h-48 overflow-hidden bg-gray-100 dark:bg-slate-900">
                        <img 
                        src={post.thumbnail} 
                        alt={post.title} 
                        className="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                        loading="lazy"
                        onError={(e) => {
                            e.target.src = 'https://placehold.co/600x315/f1f5f9/64748b?text=SEO+Update';
                        }}
                        />
                        <div className="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                    </div>
                    <div className="p-5 flex flex-col flex-grow">
                        <div className="flex items-center gap-2 text-xs font-medium text-gray-500 dark:text-gray-400 mb-3">
                            <Calendar size={12} />
                            <span>{post.date}</span>
                        </div>
                        <h3 className="text-lg font-bold text-gray-800 dark:text-white mb-3 line-clamp-2 leading-tight group-hover:text-brand-600 dark:group-hover:text-brand-400 transition-colors">
                            {post.title}
                        </h3>
                        <p className="text-sm text-gray-600 dark:text-gray-300 line-clamp-3 mb-4 flex-grow leading-relaxed">
                            {post.summary}
                        </p>
                        <div className="flex items-center text-sm font-bold text-brand-600 dark:text-brand-400 mt-auto group-hover:underline decoration-2 underline-offset-2">
                            Read Article <ArrowRight size={16} className="ml-1 transition-transform group-hover:translate-x-1" />
                        </div>
                    </div>
                </a>
                ))}
            </div>
            </div>
        );
      }

      // --- APP COMPONENT ---
      const App = () => {
        const [lang, setLang] = useState('en');
        const [isDark, setIsDark] = useState(false);
        const [input, setInput] = useState('');
        const [loading, setLoading] = useState(false);
        const [error, setError] = useState(null);
        const [seoData, setSeoData] = useState(null);
        const [generatedHtml, setGeneratedHtml] = useState('');

        const t = DICTIONARY[lang];

        useEffect(() => {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark' || (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                setIsDark(true);
                document.documentElement.classList.add('dark');
            } else {
                setIsDark(false);
                document.documentElement.classList.remove('dark');
            }
        }, []);

        useEffect(() => {
            if (isDark) {
                document.documentElement.classList.add('dark');
                localStorage.setItem('theme', 'dark');
            } else {
                document.documentElement.classList.remove('dark');
                localStorage.setItem('theme', 'light');
            }
        }, [isDark]);

        const generateHTML = (data) => {
            const keywords = Array.isArray(data.keywords) ? data.keywords.join(', ') : '';
            const tags = [
                `<title>${data.title}</title>`,
                `<meta name="description" content="${data.description}">`,
                `<meta name="keywords" content="${keywords}">`,
                `<meta name="robots" content="${data.robots}">`
            ];
            if (data.author) tags.push(`<meta name="author" content="${data.author}">`);
            tags.push(`<meta property="og:title" content="${data.title}">`);
            tags.push(`<meta property="og:description" content="${data.description}">`);
            return tags.join('\n');
        };

        const handleAnalyze = async () => {
            if (!input.trim()) {
                setError(t.errorEmpty);
                return;
            }
            setLoading(true);
            setError(null);
            setSeoData(null);
            try {
                const data = await analyzeContent(input, lang);
                setSeoData(data);
                setGeneratedHtml(generateHTML(data));
            } catch (err) {
                console.error(err);
                setError(t.errorApi);
            } finally {
                setLoading(false);
            }
        };

        const handleExport = (format) => {
            if (!seoData) return;
            let content = '';
            let mimeType = '';
            let extension = '';
            if (format === 'json') {
                content = JSON.stringify(seoData, null, 2);
                mimeType = 'application/json';
                extension = 'json';
            } else {
                content = `Title: ${seoData.title}\nDescription: ${seoData.description}\nKeywords: ${seoData.keywords.join(', ')}\n\nHTML Code:\n${generatedHtml}`;
                mimeType = 'text/plain';
                extension = 'txt';
            }
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `seo-meta-tags.${extension}`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        };

        const clearAll = () => {
            setInput('');
            setSeoData(null);
            setError(null);
        }

        return (
            <div className="min-h-screen flex flex-col font-sans selection:bg-brand-500 selection:text-white">
                <Header lang={lang} setLang={setLang} isDark={isDark} setIsDark={setIsDark} t={t} />

                {/* Top Banner */}
                <div className="w-full bg-gray-50 dark:bg-slate-950 border-b border-gray-200 dark:border-slate-800">
                    <div className="w-full max-w-[1400px] mx-auto py-4 flex justify-center items-center px-4">
                        <AdUnit adKey={AD_KEY_728_90} width={728} height={90} className="shrink-0" />
                    </div>
                </div>

                <div className="flex-grow w-full max-w-[1600px] mx-auto flex flex-col xl:flex-row justify-center gap-6 px-4 py-8">
                    {/* Left Sidebar */}
                    <aside className="hidden xl:flex flex-col gap-4 min-w-[160px] sticky top-24 h-fit">
                        <AdUnit adKey={AD_KEY_160_600} width={160} height={600} />
                    </aside>

                    {/* Main Content */}
                    <main className="flex-grow w-full max-w-5xl space-y-8">
                        <div className="bg-white dark:bg-slate-800 rounded-xl shadow-lg border border-gray-200 dark:border-slate-700 p-6 transition-all">
                            <textarea value={input} onChange={(e) => setInput(e.target.value)} placeholder={t.inputPlaceholder} className="w-full h-48 p-4 rounded-lg bg-gray-50 dark:bg-slate-900 border border-gray-200 dark:border-slate-700 text-gray-900 dark:text-gray-100 placeholder-gray-400 focus:ring-2 focus:ring-brand-500 focus:border-transparent outline-none resize-y transition-all text-base leading-relaxed" />
                            <div className="mt-4 flex flex-col sm:flex-row gap-4 justify-between items-center">
                                {error && <span className="text-red-500 text-sm font-medium animate-pulse">{error}</span>}
                                {!error && <span className="text-gray-400 text-sm hidden sm:block">{input.length} characters</span>}
                                <div className="flex flex-wrap gap-3 w-full sm:w-auto">
                                    <button onClick={clearAll} disabled={loading || !input} className="flex-1 sm:flex-none items-center justify-center gap-2 px-6 py-2.5 rounded-lg font-medium text-gray-600 dark:text-gray-300 bg-gray-100 dark:bg-slate-700 hover:bg-gray-200 dark:hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex">
                                        <Trash2 size={18} /> <span className="hidden sm:inline">{t.clear}</span>
                                    </button>
                                    <button onClick={handleAnalyze} disabled={loading || !input} className="flex-1 sm:flex-none items-center justify-center gap-2 px-6 py-2.5 rounded-lg font-bold text-white bg-gradient-to-r from-brand-600 to-indigo-600 hover:from-brand-700 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed shadow-md hover:shadow-lg transition-all transform active:scale-95 flex">
                                        {loading ? <Loader2 size={18} className="animate-spin" /> : <Wand2 size={18} />} {loading ? t.analyzing : t.generateMeta}
                                    </button>
                                </div>
                            </div>
                        </div>
                        {seoData && (
                            <div className="animate-in fade-in slide-in-from-bottom-4 duration-500">
                                <div className="flex items-center gap-2 mb-4"><h2 className="text-xl font-bold text-gray-800 dark:text-white">{t.results}</h2></div>
                                <ResultTabs data={seoData} html={generatedHtml} t={t} onExport={handleExport} />
                            </div>
                        )}
                        
                        {/* Blogger Latest Posts Widget */}
                        <LatestPosts />
                    </main>

                    {/* Right Sidebar */}
                    <aside className="hidden xl:flex flex-col gap-4 min-w-[160px] sticky top-24 h-fit">
                        <AdUnit adKey={AD_KEY_160_600} width={160} height={600} />
                    </aside>
                </div>

                {/* Bottom Banner */}
                <div className="w-full bg-gray-50 dark:bg-slate-950 border-t border-gray-200 dark:border-slate-800 mt-auto">
                    <div className="w-full max-w-[1400px] mx-auto py-4 flex justify-center items-center px-4">
                        <AdUnit adKey={AD_KEY_728_90} width={728} height={90} className="shrink-0" />
                    </div>
                </div>

                <footer className="py-8 text-center text-sm text-gray-500 dark:text-gray-400 bg-white dark:bg-slate-900 border-t border-gray-200 dark:border-slate-800">
                    <p>© {new Date().getFullYear()} Meta Tag Fixer. AI SEO Utility.</p>
                </footer>
            </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(
        <React.StrictMode>
            <App />
        </React.StrictMode>
      );
    // ]]>
    </script>
</body>
</html>